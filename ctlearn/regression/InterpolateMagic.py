import matplotlib.pyplot as plt
import numpy as np
from scipy import interpolate


class InterpolateMagic:

    def __init__(self, step=1):
        self.__xcoord_raw = np.array([0.00000, 28.34699, 5.66940, -22.67760, -28.34699, -5.66940, 22.67760, 56.69399,
                                      34.01639, 11.33880, -17.00820, -45.35519, -51.02459, -56.69399, -34.01639,
                                      -11.33880,
                                      17.00820, 45.35519, 51.02459, 85.04098, 62.36339, 39.68579, 17.00820, -11.33880,
                                      -39.68579, -68.03279, -73.70218, -79.37158, -85.04098, -62.36339, -39.68579,
                                      -17.00820,
                                      11.33880, 39.68579, 68.03279, 73.70218, 79.37158, 113.38798, 90.71038, 68.03279,
                                      45.35519, 22.67760, -5.66940, -34.01639, -62.36339, -90.71038, -96.37978,
                                      -102.04918,
                                      -107.71858, -113.38798, -90.71038, -68.03279, -45.35519, -22.67760, 5.66940,
                                      34.01639,
                                      62.36339, 90.71038, 96.37978, 102.04918, 107.71858, 141.73497, 119.05737,
                                      96.37978,
                                      73.70218, 51.02459, 28.34699, 0.00000, -28.34699, -56.69399, -85.04098,
                                      -113.38798,
                                      -119.05737, -124.72677, -130.39617, -136.06557, -141.73497, -119.05737, -96.37978,
                                      -73.70218,
                                      -51.02459, -28.34699, -0.00000, 28.34699, 56.69399, 85.04098, 113.38798,
                                      119.05737,
                                      124.72677, 130.39617, 136.06557, 170.08196, 147.40437, 124.72677, 102.04918,
                                      79.37158,
                                      56.69399, 34.01639, 5.66940, -22.67760, -51.02459, -79.37158, -107.71858,
                                      -136.06557,
                                      -141.73497, -147.40437, -153.07377, -158.74317, -164.41256, -170.08196,
                                      -147.40437,
                                      -124.72677,
                                      -102.04918, -79.37158, -56.69399, -34.01639, -5.66940, 22.67760, 51.02459,
                                      79.37158,
                                      107.71858, 136.06557, 141.73497, 147.40437, 153.07377, 158.74317, 164.41256,
                                      198.42896,
                                      175.75136, 153.07377, 130.39617, 107.71858, 85.04098, 62.36339, 39.68579,
                                      11.33880,
                                      -17.00820, -45.35519, -73.70218, -102.04918, -130.39617, -158.74317, -164.41256,
                                      -170.08196,
                                      -175.75136, -181.42076, -187.09016, -192.75956, -198.42896, -175.75136,
                                      -153.07377,
                                      -130.39617,
                                      -107.71858, -85.04098, -62.36339, -39.68579, -11.33880, 17.00820, 45.35519,
                                      73.70218,
                                      102.04918, 130.39617, 158.74317, 164.41256, 170.08196, 175.75136, 181.42076,
                                      187.09016,
                                      192.75956, 226.77595, 204.09836, 181.42076, 158.74317, 136.06557, 113.38798,
                                      90.71038,
                                      68.03279, 45.35519, 17.00820, -11.33880, -39.68579, -68.03279, -96.37978,
                                      -124.72677,
                                      -153.07377, -181.42076, -187.09016, -192.75956, -198.42896, -204.09836,
                                      -209.76775,
                                      -215.43715,
                                      -221.10655, -226.77595, -204.09836, -181.42076, -158.74317, -136.06557,
                                      -113.38798,
                                      -90.71038,
                                      -68.03279, -45.35519, -17.00820, 11.33880, 39.68579, 68.03279, 96.37978,
                                      124.72677,
                                      153.07377, 181.42076, 187.09016, 192.75956, 198.42896, 204.09836, 209.76775,
                                      215.43715,
                                      221.10655, 255.12294, 232.44535, 209.76775, 187.09016, 164.41256, 141.73497,
                                      119.05737,
                                      96.37978, 73.70218, 51.02459, 22.67760, -5.66940, -34.01639, -62.36339, -90.71038,
                                      -119.05737, -147.40437, -175.75136, -204.09836, -209.76775, -215.43715,
                                      -221.10655,
                                      -226.77595,
                                      -232.44535, -238.11475, -243.78415, -249.45355, -255.12294, -232.44535,
                                      -209.76775,
                                      -187.09016,
                                      -164.41256, -141.73497, -119.05737, -96.37978, -73.70218, -51.02459, -22.67760,
                                      5.66940,
                                      34.01639, 62.36339, 90.71038, 119.05737, 147.40437, 175.75136, 204.09836,
                                      209.76775,
                                      215.43715, 221.10655, 226.77595, 232.44535, 238.11475, 243.78415, 249.45355,
                                      283.46994,
                                      260.79234, 238.11475, 215.43715, 192.75956, 170.08196, 147.40437, 124.72677,
                                      102.04918,
                                      79.37158, 56.69399, 28.34699, 0.00000, -28.34699, -56.69399, -85.04098,
                                      -113.38798,
                                      -141.73497, -170.08196, -198.42896, -226.77595, -232.44535, -238.11475,
                                      -243.78415,
                                      -249.45355,
                                      -255.12294, -260.79234, -266.46174, -272.13114, -277.80054, -283.46994,
                                      -260.79234,
                                      -238.11475,
                                      -215.43715, -192.75956, -170.08196, -147.40437, -124.72677, -102.04918, -79.37158,
                                      -56.69399,
                                      -28.34699, -0.00000, 28.34699, 56.69399, 85.04098, 113.38798, 141.73497,
                                      170.08196,
                                      198.42896, 226.77595, 232.44535, 238.11475, 243.78415, 249.45355, 255.12294,
                                      260.79234,
                                      266.46174, 272.13114, 277.80054, 311.81693, 289.13934, 266.46174, 243.78415,
                                      221.10655,
                                      198.42896, 175.75136, 153.07377, 130.39617, 107.71858, 85.04098, 62.36339,
                                      34.01639,
                                      5.66940, -22.67760, -51.02459, -79.37158, -107.71858, -136.06557, -164.41256,
                                      -192.75956,
                                      -221.10655, -249.45355, -255.12294, -260.79234, -266.46174, -272.13114,
                                      -277.80054,
                                      -283.46994,
                                      -289.13934, -294.80874, -300.47814, -306.14753, -311.81693, -289.13934,
                                      -266.46174,
                                      -243.78415,
                                      -221.10655, -198.42896, -175.75136, -153.07377, -130.39617, -107.71858, -85.04098,
                                      -62.36339,
                                      -34.01639, -5.66940, 22.67760, 51.02459, 79.37158, 107.71858, 136.06557,
                                      164.41256,
                                      192.75956, 221.10655, 249.45355, 255.12294, 260.79234, 266.46174, 272.13114,
                                      277.80054,
                                      283.46994, 289.13934, 294.80874, 300.47814, 306.14753, 340.16393, 317.48633,
                                      294.80874,
                                      272.13114, 249.45355, 226.77595, 204.09836, 181.42076, 158.74317, 136.06557,
                                      113.38798,
                                      90.71038, 68.03279, 39.68579, 11.33880, -17.00820, -45.35519, -73.70218,
                                      -102.04918,
                                      -130.39617, -158.74317, -187.09016, -215.43715, -243.78415, -272.13114,
                                      -277.80054,
                                      -283.46994,
                                      -289.13934, -294.80874, -300.47814, -306.14753, -311.81693, -317.48633,
                                      -323.15573,
                                      -328.82513,
                                      -334.49453, -340.16393, -317.48633, -294.80874, -272.13114, -249.45355,
                                      -226.77595,
                                      -204.09836,
                                      -181.42076, -158.74317, -136.06557, -113.38798, -90.71038, -68.03279, -39.68579,
                                      -11.33880,
                                      17.00820, 45.35519, 73.70218, 102.04918, 130.39617, 158.74317, 187.09016,
                                      215.43715,
                                      243.78415, 272.13114, 277.80054, 283.46994, 289.13934, 294.80874, 300.47814,
                                      306.14753,
                                      311.81693, 317.48633, 323.15573, 328.82513, 334.49453, 368.51092, 345.83333,
                                      323.15573,
                                      300.47814, 277.80054, 255.12294, 232.44535, 209.76775, 187.09016, 164.41256,
                                      141.73497,
                                      119.05737, 96.37978, 73.70218, 45.35519, 17.00820, -11.33880, -39.68579,
                                      -68.03279,
                                      -96.37978, -124.72677, -153.07377, -181.42076, -209.76775, -238.11475, -266.46174,
                                      -294.80874,
                                      -300.47814, -306.14753, -311.81693, -317.48633, -323.15573, -328.82513,
                                      -334.49453,
                                      -340.16393,
                                      -345.83333, -351.50272, -357.17212, -362.84152, -368.51092, -345.83333,
                                      -323.15573,
                                      -300.47814,
                                      -277.80054, -255.12294, -232.44535, -209.76775, -187.09016, -164.41256,
                                      -141.73497,
                                      -119.05737,
                                      -96.37978, -73.70218, -45.35519, -17.00820, 11.33880, 39.68579, 68.03279,
                                      96.37978,
                                      124.72677, 153.07377, 181.42076, 209.76775, 238.11475, 266.46174, 294.80874,
                                      300.47814,
                                      306.14753, 311.81693, 317.48633, 323.15573, 328.82513, 334.49453, 340.16393,
                                      345.83333,
                                      351.50272, 357.17212, 362.84152, 396.85791, 374.18032, 351.50272, 328.82513,
                                      306.14753,
                                      283.46994, 260.79234, 238.11475, 215.43715, 192.75956, 170.08196, 147.40437,
                                      124.72677,
                                      102.04918, 79.37158, 51.02459, 22.67760, -5.66940, -34.01639, -62.36339,
                                      -90.71038,
                                      -119.05737, -147.40437, -175.75136, -204.09836, -232.44535, -260.79234,
                                      -289.13934,
                                      -317.48633,
                                      -323.15573, -328.82513, -334.49453, -340.16393, -345.83333, -351.50272,
                                      -357.17212,
                                      -362.84152,
                                      -368.51092, -374.18032, -379.84972, -385.51912, -391.18852, -396.85791,
                                      -374.18032,
                                      -351.50272,
                                      -328.82513, -306.14753, -283.46994, -260.79234, -238.11475, -215.43715,
                                      -192.75956,
                                      -170.08196,
                                      -147.40437, -124.72677, -102.04918, -79.37158, -51.02459, -22.67760, 5.66940,
                                      34.01639,
                                      62.36339, 90.71038, 119.05737, 147.40437, 175.75136, 204.09836, 232.44535,
                                      260.79234,
                                      289.13934, 317.48633, 323.15573, 328.82513, 334.49453, 340.16393, 345.83333,
                                      351.50272,
                                      357.17212, 362.84152, 368.51092, 374.18032, 379.84972, 385.51912, 391.18852,
                                      425.20491,
                                      402.52731, 379.84972, 357.17212, 334.49453, 311.81693, 289.13934, 266.46174,
                                      243.78415,
                                      221.10655, 198.42896, 175.75136, 153.07377, 130.39617, 107.71858, 85.04098,
                                      56.69399,
                                      28.34699, 0.00000, -28.34699, -56.69399, -85.04098, -113.38798, -141.73497,
                                      -170.08196,
                                      -198.42896, -226.77595, -255.12294, -283.46994, -311.81693, -340.16393,
                                      -345.83333,
                                      -351.50272,
                                      -357.17212, -362.84152, -368.51092, -374.18032, -379.84972, -385.51912,
                                      -391.18852,
                                      -396.85791,
                                      -402.52731, -408.19671, -413.86611, -419.53551, -425.20491, -402.52731,
                                      -379.84972,
                                      -357.17212,
                                      -334.49453, -311.81693, -289.13934, -266.46174, -243.78415, -221.10655,
                                      -198.42896,
                                      -175.75136,
                                      -153.07377, -130.39617, -107.71858, -85.04098, -56.69399, -28.34699, -0.00000,
                                      28.34699,
                                      56.69399, 85.04098, 113.38798, 141.73497, 170.08196, 198.42896, 226.77595,
                                      255.12294,
                                      283.46994, 311.81693, 340.16393, 345.83333, 351.50272, 357.17212, 362.84152,
                                      368.51092,
                                      374.18032, 379.84972, 385.51912, 391.18852, 396.85791, 402.52731, 408.19671,
                                      413.86611,
                                      419.53551, 453.55190, 430.87431, 408.19671, 385.51912, 362.84152, 340.16393,
                                      317.48633,
                                      294.80874, 272.13114, 249.45355, 226.77595, 204.09836, 181.42076, 158.74317,
                                      136.06557,
                                      113.38798, 90.71038, 62.36339, 34.01639, 5.66940, -22.67760, -51.02459, -79.37158,
                                      -107.71858, -136.06557, -164.41256, -192.75956, -221.10655, -249.45355,
                                      -277.80054,
                                      -306.14753,
                                      -334.49453, -362.84152, -368.51092, -374.18032, -379.84972, -385.51912,
                                      -391.18852,
                                      -396.85791,
                                      -402.52731, -408.19671, -413.86611, -419.53551, -425.20491, -430.87431,
                                      -436.54371,
                                      -442.21310,
                                      -447.88250, -453.55190, -430.87431, -408.19671, -385.51912, -362.84152,
                                      -340.16393,
                                      -317.48633,
                                      -294.80874, -272.13114, -249.45355, -226.77595, -204.09836, -181.42076,
                                      -158.74317,
                                      -136.06557,
                                      -113.38798, -90.71038, -62.36339, -34.01639, -5.66940, 22.67760, 51.02459,
                                      79.37158,
                                      107.71858, 136.06557, 164.41256, 192.75956, 221.10655, 249.45355, 277.80054,
                                      306.14753,
                                      334.49453, 362.84152, 368.51092, 374.18032, 379.84972, 385.51912, 391.18852,
                                      396.85791,
                                      402.52731, 408.19671, 413.86611, 419.53551, 425.20491, 430.87431, 436.54371,
                                      442.21310,
                                      447.88250, 459.22130, 436.54371, 413.86611, 391.18852, 368.51092, 345.83333,
                                      323.15573,
                                      300.47814, 277.80054, 255.12294, 232.44535, 209.76775, 187.09016, 164.41256,
                                      141.73497,
                                      119.05737, 68.03279, 39.68579, 11.33880, -17.00820, -45.35519, -73.70218,
                                      -102.04918,
                                      -130.39617, -158.74317, -187.09016, -215.43715, -243.78415, -272.13114,
                                      -300.47814,
                                      -328.82513,
                                      -357.17212, -391.18852, -396.85791, -402.52731, -408.19671, -413.86611,
                                      -419.53551,
                                      -425.20491,
                                      -430.87431, -436.54371, -442.21310, -447.88250, -453.55190, -459.22130,
                                      -464.89070,
                                      -470.56010,
                                      -476.22950, -459.22130, -436.54371, -413.86611, -391.18852, -368.51092,
                                      -345.83333,
                                      -323.15573,
                                      -300.47814, -277.80054, -255.12294, -232.44535, -209.76775, -187.09016,
                                      -164.41256,
                                      -141.73497,
                                      -119.05737, -68.03279, -39.68579, -11.33880, 17.00820, 45.35519, 73.70218,
                                      102.04918,
                                      130.39617, 158.74317, 187.09016, 215.43715, 243.78415, 272.13114, 300.47814,
                                      328.82513,
                                      357.17212, 391.18852, 396.85791, 402.52731, 408.19671, 413.86611, 419.53551,
                                      425.20491,
                                      430.87431, 436.54371, 442.21310, 447.88250, 453.55190, 459.22130, 464.89070,
                                      470.56010,
                                      476.22950, 442.21310, 419.53551, 396.85791, 374.18032, 351.50272, 328.82513,
                                      306.14753,
                                      283.46994, 260.79234, 238.11475, 215.43715, 192.75956, 170.08196, 17.00820,
                                      -11.33880,
                                      -39.68579, -68.03279, -96.37978, -124.72677, -153.07377, -181.42076, -209.76775,
                                      -238.11475,
                                      -266.46174, -294.80874, -323.15573, -425.20491, -430.87431, -436.54371,
                                      -442.21310,
                                      -447.88250,
                                      -453.55190, -459.22130, -464.89070, -470.56010, -476.22950, -481.89890,
                                      -487.56829,
                                      -493.23769,
                                      -442.21310, -419.53551, -396.85791, -374.18032, -351.50272, -328.82513,
                                      -306.14753,
                                      -283.46994,
                                      -260.79234, -238.11475, -215.43715, -192.75956, -170.08196, -17.00820, 11.33880,
                                      39.68579,
                                      68.03279, 96.37978, 124.72677, 153.07377, 181.42076, 209.76775, 238.11475,
                                      266.46174,
                                      294.80874, 323.15573, 425.20491, 430.87431, 436.54371, 442.21310, 447.88250,
                                      453.55190,
                                      459.22130, 464.89070, 470.56010, 476.22950, 481.89890, 487.56829, 493.23769,
                                      402.52731,
                                      379.84972, 357.17212, 334.49453, 311.81693, 289.13934, 266.46174, 243.78415,
                                      -62.36339,
                                      -90.71038, -119.05737, -147.40437, -175.75136, -204.09836, -232.44535, -260.79234,
                                      -464.89070,
                                      -470.56010, -476.22950, -481.89890, -487.56829, -493.23769, -498.90709,
                                      -504.57649,
                                      -402.52731,
                                      -379.84972, -357.17212, -334.49453, -311.81693, -289.13934, -266.46174,
                                      -243.78415,
                                      62.36339,
                                      90.71038, 119.05737, 147.40437, 175.75136, 204.09836, 232.44535, 260.79234,
                                      464.89070,
                                      470.56010, 476.22950, 481.89890, 487.56829, 493.23769, 498.90709, 504.57649,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
                                      400.00000,
                                      400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000])
        self.__ycoord_raw = np.array(
            [0.00000, 9.81969, 29.45906, 19.63937, -9.81969, -29.45906, -19.63937, 19.63937,  # 8
             39.27875, 58.91812, 49.09843, 39.27875, 9.81969, -19.63937, -39.27875, -58.91812,  # 16
             -49.09843, -39.27875, -9.81969, 29.45906, 49.09843, 68.73781, 88.37718, 78.55749,  # 24
             68.73781, 58.91812, 29.45906, 0.00000, -29.45906, -49.09843, -68.73781, -88.37718,
             # 32
             -78.55749, -68.73781, -58.91812, -29.45906, 0.00000, 39.27875, 58.91812, 78.55749,
             # 40
             98.19687, 117.83624, 108.01655, 98.19687, 88.37718, 78.55749, 49.09843, 19.63937,  # 48
             -9.81969, -39.27875, -58.91812, -78.55749, -98.19687, -117.83624, -108.01655,
             -98.19687,  # 56
             -88.37718, -78.55749, -49.09843, -19.63937, 9.81969, 49.09843, 68.73781, 88.37718,
             # 64
             108.01655, 127.65593, 147.29530, 137.47561, 127.65593, 117.83624, 108.01655, 98.19687,
             # 72
             68.73781, 39.27875, 9.81969, -19.63937, -49.09843, -68.73781, -88.37718, -108.01655,
             # 80
             -127.65593, -147.29530, -137.47561, -127.65593, -117.83624, -108.01655, -98.19687,
             -68.73781,  # 88
             -39.27875, -9.81969, 19.63937, 58.91812, 78.55749, 98.19687, 117.83624, 137.47561,
             # 96
             157.11499, 176.75436, 166.93467, 157.11499, 147.29530, 137.47561, 127.65593, 117.83624,
             # 104
             88.37718, 58.91812, 29.45906, 0.00000, -29.45906, -58.91812, -78.55749, -98.19687,
             # 112
             -117.83624, -137.47561, -157.11499, -176.75436, -166.93467, -157.11499, -147.29530,
             -137.47561,  # 120
             -127.65593, -117.83624, -88.37718, -58.91812, -29.45906, 0.00000, 29.45906, 68.73781,
             # 128
             88.37718, 108.01655, 127.65593, 147.29530, 166.93467, 186.57405, 206.21342, 196.39373,
             # 136
             186.57405, 176.75436, 166.93467, 157.11499, 147.29530, 137.47561, 108.01655, 78.55749,
             # 144
             49.09843, 19.63937, -9.81969, -39.27875, -68.73781, -88.37718, -108.01655, -127.65593,
             # 152
             -147.29530, -166.93467, -186.57405, -206.21342, -196.39373, -186.57405, -176.75436,
             -166.93467,  # 160
             -157.11499, -147.29530, -137.47561, -108.01655, -78.55749, -49.09843, -19.63937,
             9.81969,  # 168
             39.27875, 78.55749, 98.19687, 117.83624, 137.47561, 157.11499, 176.75436, 196.39373,
             # 176
             216.03311, 235.67248, 225.85279, 216.03311, 206.21342, 196.39373, 186.57405, 176.75436,
             # 184
             166.93467, 157.11499, 127.65593, 98.19687, 68.73781, 39.27875, 9.81969, -19.63937,
             # 192
             -49.09843, -78.55749, -98.19687, -117.83624, -137.47561, -157.11499, -176.75436,
             -196.39373,  # 200
             -216.03311, -235.67248, -225.85279, -216.03311, -206.21342, -196.39373, -186.57405,
             -176.75436,  # 208
             -166.93467, -157.11499, -127.65593, -98.19687, -68.73781, -39.27875, -9.81969,
             19.63937,  # 216
             49.09843, 88.37718, 108.01655, 127.65593, 147.29530, 166.93467, 186.57405, 206.21342,
             # 224
             225.85279, 245.49217, 265.13154, 255.31185, 245.49217, 235.67248, 225.85279, 216.03311,
             # 232
             206.21342, 196.39373, 186.57405, 176.75436, 147.29530, 117.83624, 88.37718, 58.91812,
             # 240
             29.45906, 0.00000, -29.45906, -58.91812, -88.37718, -108.01655, -127.65593, -147.29530,
             # 248
             -166.93467, -186.57405, -206.21342, -225.85279, -245.49217, -265.13154, -255.31185,
             -245.49217,  # 256
             -235.67248, -225.85279, -216.03311, -206.21342, -196.39373, -186.57405, -176.75436,
             -147.29530,  # 264
             -117.83624, -88.37718, -58.91812, -29.45906, 0.00000, 29.45906, 58.91812, 98.19687,
             # 272
             117.83624, 137.47561, 157.11499, 176.75436, 196.39373, 216.03311, 235.67248, 255.31185,
             # 280
             274.95123, 294.59060, 284.77092, 274.95123, 265.13154, 255.31185, 245.49217, 235.67248,
             # 288
             225.85279, 216.03311, 206.21342, 196.39373, 166.93467, 137.47561, 108.01655, 78.55749,
             # 296
             49.09843, 19.63937, -9.81969, -39.27875, -68.73781, -98.19687, -117.83624, -137.47561,
             # 304
             -157.11499, -176.75436, -196.39373, -216.03311, -235.67248, -255.31185, -274.95123,
             -294.59060,  # 312
             -284.77092, -274.95123, -265.13154, -255.31185, -245.49217, -235.67248, -225.85279,
             -216.03311,  # 320
             -206.21342, -196.39373, -166.93467, -137.47561, -108.01655, -78.55749, -49.09843,
             -19.63937,  # 328
             9.81969, 39.27875, 68.73781, 108.01655, 127.65593, 147.29530, 166.93467, 186.57405,
             # 336
             206.21342, 225.85279, 245.49217, 265.13154, 284.77092, 304.41029, 324.04966, 314.22998,
             # 344
             304.41029, 294.59060, 284.77092, 274.95123, 265.13154, 255.31185, 245.49217, 235.67248,
             # 352
             225.85279, 216.03311, 186.57405, 157.11499, 127.65593, 98.19687, 68.73781, 39.27875,
             # 360
             9.81969, -19.63937, -49.09843, -78.55749, -108.01655, -127.65593, -147.29530,
             -166.93467,  # 368
             -186.57405, -206.21342, -225.85279, -245.49217, -265.13154, -284.77092, -304.41029,
             -324.04966,  # 376
             -314.22998, -304.41029, -294.59060, -284.77092, -274.95123, -265.13154, -255.31185,
             -245.49217,  # 384
             -235.67248, -225.85279, -216.03311, -186.57405, -157.11499, -127.65593, -98.19687,
             -68.73781,  # 392
             -39.27875, -9.81969, 19.63937, 49.09843, 78.55749, 117.83624, 137.47561, 157.11499,
             # 400
             176.75436, 196.39373, 216.03311, 235.67248, 255.31185, 274.95123, 294.59060, 314.22998,
             # 408
             333.86935, 353.50872, 343.68904, 333.86935, 324.04966, 314.22998, 304.41029, 294.59060,
             # 416
             284.77092, 274.95123, 265.13154, 255.31185, 245.49217, 235.67248, 206.21342, 176.75436,
             # 424
             147.29530, 117.83624, 88.37718, 58.91812, 29.45906, 0.00000, -29.45906, -58.91812,
             # 432
             -88.37718, -117.83624, -137.47561, -157.11499, -176.75436, -196.39373, -216.03311,
             -235.67248,  # 440
             -255.31185, -274.95123, -294.59060, -314.22998, -333.86935, -353.50872, -343.68904,
             -333.86935,  # 448
             -324.04966, -314.22998, -304.41029, -294.59060, -284.77092, -274.95123, -265.13154,
             -255.31185,  # 456
             -245.49217, -235.67248, -206.21342, -176.75436, -147.29530, -117.83624, -88.37718,
             -58.91812,  # 464
             -29.45906, 0.00000, 29.45906, 58.91812, 88.37718, 127.65593, 147.29530, 166.93467,
             # 472
             186.57405, 206.21342, 225.85279, 245.49217, 265.13154, 284.77092, 304.41029, 324.04966,
             # 480
             343.68904, 363.32841, 382.96778, 373.14810, 363.32841, 353.50872, 343.68904, 333.86935,
             # 488
             324.04966, 314.22998, 304.41029, 294.59060, 284.77092, 274.95123, 265.13154, 255.31185,
             # 496
             225.85279, 196.39373, 166.93467, 137.47561, 108.01655, 78.55749, 49.09843, 19.63937,
             # 504
             -9.81969, -39.27875, -68.73781, -98.19687, -127.65593, -147.29530, -166.93467,
             -186.57405,  # 512
             -206.21342, -225.85279, -245.49217, -265.13154, -284.77092, -304.41029, -324.04966,
             -343.68904,  # 520
             -363.32841, -382.96778, -373.14810, -363.32841, -353.50872, -343.68904, -333.86935,
             -324.04966,  # 528
             -314.22998, -304.41029, -294.59060, -284.77092, -274.95123, -265.13154, -255.31185,
             -225.85279,  # 536
             -196.39373, -166.93467, -137.47561, -108.01655, -78.55749, -49.09843, -19.63937,
             9.81969,  # 544
             39.27875, 68.73781, 98.19687, 137.47561, 157.11499, 176.75436, 196.39373, 216.03311,
             # 552
             235.67248, 255.31185, 274.95123, 294.59060, 314.22998, 333.86935, 353.50872, 373.14810,
             # 560
             392.78747, 412.42684, 402.60716, 392.78747, 382.96778, 373.14810, 363.32841, 353.50872,
             # 568
             343.68904, 333.86935, 324.04966, 314.22998, 304.41029, 294.59060, 284.77092, 274.95123,
             # 576
             245.49217, 216.03311, 186.57405, 157.11499, 127.65593, 98.19687, 68.73781, 39.27875,
             # 584
             9.81969, -19.63937, -49.09843, -78.55749, -108.01655, -137.47561, -157.11499,
             -176.75436,  # 592
             -196.39373, -216.03311, -235.67248, -255.31185, -274.95123, -294.59060, -314.22998,
             -333.86935,  # 600
             -353.50872, -373.14810, -392.78747, -412.42684, -402.60716, -392.78747, -382.96778,
             -373.14810,  # 608
             -363.32841, -353.50872, -343.68904, -333.86935, -324.04966, -314.22998, -304.41029,
             -294.59060,  # 616
             -284.77092, -274.95123, -245.49217, -216.03311, -186.57405, -157.11499, -127.65593,
             -98.19687,  # 624
             -68.73781, -39.27875, -9.81969, 19.63937, 49.09843, 78.55749, 108.01655, 147.29530,
             # 632
             166.93467, 186.57405, 206.21342, 225.85279, 245.49217, 265.13154, 284.77092, 304.41029,
             # 640
             324.04966, 343.68904, 363.32841, 382.96778, 402.60716, 422.24653, 441.88590, 432.06622,
             # 648
             422.24653, 412.42684, 402.60716, 392.78747, 382.96778, 373.14810, 363.32841, 353.50872,
             # 656
             343.68904, 333.86935, 324.04966, 314.22998, 304.41029, 294.59060, 265.13154, 235.67248,
             # 664
             206.21342, 176.75436, 147.29530, 117.83624, 88.37718, 58.91812, 29.45906, 0.00000,
             # 672
             -29.45906, -58.91812, -88.37718, -117.83624, -147.29530, -166.93467, -186.57405,
             -206.21342,  # 680
             -225.85279, -245.49217, -265.13154, -284.77092, -304.41029, -324.04966, -343.68904,
             -363.32841,  # 688
             -382.96778, -402.60716, -422.24653, -441.88590, -432.06622, -422.24653, -412.42684,
             -402.60716,  # 696
             -392.78747, -382.96778, -373.14810, -363.32841, -353.50872, -343.68904, -333.86935,
             -324.04966,  # 704
             -314.22998, -304.41029, -294.59060, -265.13154, -235.67248, -206.21342, -176.75436,
             -147.29530,  # 712
             -117.83624, -88.37718, -58.91812, -29.45906, 0.00000, 29.45906, 58.91812, 88.37718,
             # 720
             117.83624, 157.11499, 176.75436, 196.39373, 216.03311, 235.67248, 255.31185, 274.95123,
             # 728
             294.59060, 314.22998, 333.86935, 353.50872, 373.14810, 392.78747, 412.42684, 432.06622,
             # 736
             451.70559, 471.34496, 461.52528, 451.70559, 441.88590, 432.06622, 422.24653, 412.42684,
             # 744
             402.60716, 392.78747, 382.96778, 373.14810, 363.32841, 353.50872, 343.68904, 333.86935,
             # 752
             324.04966, 314.22998, 284.77092, 255.31185, 225.85279, 196.39373, 166.93467, 137.47561,
             # 760
             108.01655, 78.55749, 49.09843, 19.63937, -9.81969, -39.27875, -68.73781, -98.19687,
             # 768
             -127.65593, -157.11499, -176.75436, -196.39373, -216.03311, -235.67248, -255.31185,
             -274.95123,  # 776
             -294.59060, -314.22998, -333.86935, -353.50872, -373.14810, -392.78747, -412.42684,
             -432.06622,  # 784
             -451.70559, -471.34496, -461.52528, -451.70559, -441.88590, -432.06622, -422.24653,
             -412.42684,  # 792
             -402.60716, -392.78747, -382.96778, -373.14810, -363.32841, -353.50872, -343.68904,
             -333.86935,  # 800
             -324.04966, -314.22998, -284.77092, -255.31185, -225.85279, -196.39373, -166.93467,
             -137.47561,  # 808
             -108.01655, -78.55749, -49.09843, -19.63937, 9.81969, 39.27875, 68.73781, 98.19687,
             # 816
             127.65593, 186.57405, 206.21342, 225.85279, 245.49217, 265.13154, 284.77092, 304.41029,
             # 824
             324.04966, 343.68904, 363.32841, 382.96778, 402.60716, 422.24653, 441.88590, 461.52528,
             # 832
             481.16465, 490.98434, 481.16465, 471.34496, 461.52528, 451.70559, 441.88590, 432.06622,
             # 840
             422.24653, 412.42684, 402.60716, 392.78747, 382.96778, 373.14810, 363.32841, 353.50872,
             # 848
             343.68904, 304.41029, 274.95123, 245.49217, 216.03311, 186.57405, 157.11499, 127.65593,
             # 856
             98.19687, 68.73781, 39.27875, 9.81969, -19.63937, -49.09843, -78.55749, -108.01655,
             # 864
             -137.47561, -186.57405, -206.21342, -225.85279, -245.49217, -265.13154, -284.77092,
             -304.41029,  # 872
             -324.04966, -343.68904, -363.32841, -382.96778, -402.60716, -422.24653, -441.88590,
             -461.52528,  # 880
             -481.16465, -490.98434, -481.16465, -471.34496, -461.52528, -451.70559, -441.88590,
             -432.06622,  # 888
             -422.24653, -412.42684, -402.60716, -392.78747, -382.96778, -373.14810, -363.32841,
             -353.50872,  # 896
             -343.68904, -304.41029, -274.95123, -245.49217, -216.03311, -186.57405, -157.11499,
             -127.65593,  # 904
             -98.19687, -68.73781, -39.27875, -9.81969, 19.63937, 49.09843, 78.55749, 108.01655,
             # 912
             137.47561, 235.67248, 255.31185, 274.95123, 294.59060, 314.22998, 333.86935, 353.50872,
             # 920
             373.14810, 392.78747, 412.42684, 432.06622, 451.70559, 471.34496, 500.80402, 490.98434,
             # 928
             481.16465, 471.34496, 461.52528, 451.70559, 441.88590, 432.06622, 422.24653, 412.42684,
             # 936
             402.60716, 392.78747, 382.96778, 265.13154, 235.67248, 206.21342, 176.75436, 147.29530,
             # 944
             117.83624, 88.37718, 58.91812, 29.45906, 0.00000, -29.45906, -58.91812, -88.37718,
             # 952
             -235.67248, -255.31185, -274.95123, -294.59060, -314.22998, -333.86935, -353.50872,
             -373.14810,  # 960
             -392.78747, -412.42684, -432.06622, -451.70559, -471.34496, -500.80402, -490.98434,
             -481.16465,  # 968
             -471.34496, -461.52528, -451.70559, -441.88590, -432.06622, -422.24653, -412.42684,
             -402.60716,  # 976
             -392.78747, -382.96778, -265.13154, -235.67248, -206.21342, -176.75436, -147.29530,
             -117.83624,  # 984
             -88.37718, -58.91812, -29.45906, 0.00000, 29.45906, 58.91812, 88.37718, 304.41029,
             # 992
             324.04966, 343.68904, 363.32841, 382.96778, 402.60716, 422.24653, 441.88590, 500.80402,
             # 1000
             490.98434, 481.16465, 471.34496, 461.52528, 451.70559, 441.88590, 432.06622, 196.39373,
             # 1008
             166.93467, 137.47561, 108.01655, 78.55749, 49.09843, 19.63937, -9.81969, -304.41029,
             -324.04966, -343.68904, -363.32841, -382.96778, -402.60716, -422.24653, -441.88590,
             -500.80402,
             -490.98434, -481.16465, -471.34496, -461.52528, -451.70559, -441.88590, -432.06622,
             -196.39373,
             -166.93467, -137.47561, -108.01655, -78.55749, -49.09843, -19.63937, 9.81969,
             400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000,
             400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000, 400.00000])

        self.__xcoord = self.__xcoord_raw[:-144]
        self.__ycoord = self.__ycoord_raw[:-144]

        self.__x_edge_max = np.max(self.__xcoord)
        self.__x_edge_min = np.min(self.__xcoord)

        self.__y_edge_max = np.max(self.__ycoord)
        self.__y_edge_min = np.min(self.__ycoord)

        self.step = step
        self._x = np.arange(self.__x_edge_min, self.__x_edge_max, step)
        self._y = np.arange(self.__y_edge_min, self.__y_edge_max, step)
        self._XX, self._YY = np.meshgrid(self._x, self._y)

    def interpolate(self, intensity, method='linear', remove_last=True, plot=False):
        if remove_last:
            intensity = intensity[:-144]
        interpolated_result = interpolate.griddata(points=(self.__xcoord, self.__ycoord),
                                                   values=intensity,
                                                   xi=(self._XX, self._YY),
                                                   fill_value=0,
                                                   method=method)
        if plot:
            plt.pcolormesh(self._XX, self._YY, interpolated_result)
            plt.colorbar()
            plt.title('Linear Interpolation with step:' + str(self.step))
            plt.savefig('interp.jpg')
            plt.show()
        return interpolated_result

    def interp_pos(self, pos):
        pos_x = pos[0]
        pos_y = pos[1]
        idx = np.argmin((self.__xcoord - pos_x) ** 2 + (self.__ycoord - pos_y) ** 2)  # index that give lowest MSE
        # idx_y = np.argmin((self.__ycoord - pos_y)**2)  # index that give lowest MSE
        # print(idx)
        # print(idx)
        values_pos = np.zeros(len(self.__xcoord))
        values_pos[idx] = 10
        interpolated_result = interpolate.griddata(points=(self.__xcoord, self.__ycoord),
                                                   values=values_pos,
                                                   xi=(self._XX, self._YY),
                                                   fill_value=0,
                                                   method='linear')
        pos_int = np.where(interpolated_result == np.max(interpolated_result))
        pos_int_x = pos_int[1][0]
        pos_int_y = pos_int[0][0]
        return pos_int_x, pos_int_y

## Test code

# test = InterpolateMagic(15)
# import time
#
# ou = np.random.randn(1183) * 5
#
# bef = time.time()
# for _ in range(10):
#     out = test.interpolate(ou, plot=True)
#
# print('time elapsed: = ', str(time.time() - bef))
